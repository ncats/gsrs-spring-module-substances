include "gsrs-core.conf"
spring.jackson.deserialization.fail-on-unknown-properties=false
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
spring.jpa.properties.hibernate.format_sql=true

#spring.rabbitmq.host=localhost
#eureka.instance.preferIpAddress=false
#eureka.instance.hostname=localhost
ix.structure{
    base = ${ix.home}/structure
}
ix.sequence{
    base = ${ix.home}/sequence
}
gsrs.rabbitmq.enabled = false

ix.core.structureIndex.atomLimit = 240

ix.structure-hasher = "ix.core.chem.InchiStructureHasher"
ix.structure-standardizer = "ix.core.chem.InchiStandardizer"

ix.json.typeIdResolvers = ["ix", "gsrs.module.substance"]
gsrs.validators.substances = [
                               # public Class validatorClass;
                               #  public Class substanceClass;
                               #  public Substance.SubstanceDefinitionType type;

                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.IgnoreValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NullCheckValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",

                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.AutoGenerateUuidIfNeeded",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 #validates that any structural modifications are effectively non-null
                                 "validatorClass" = "ix.ginas.utils.validation.validators.StructuralModificationsValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.SubstanceStatusValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.RemovePublicIndReferences",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NamesValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.CodesValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PrimaryRelationshipsValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NotesValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PrimaryDefinitionValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.AlternateDefinitionValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "ALTERNATIVE"
                                 "configClass" = "SubstanceValidatorConfig"
                               },

                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.ChemicalValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "chemical",
                                 #September 2020: additional parameter 'allow0AtomStructures' when true -> user can register blank structures; false -> no blank structures
                                 "parameters"= {"allow0AtomStructures":false }
                                "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.MixtureValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "mixture"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               #{
                               #  "validatorClass" = "ix.ginas.utils.validation.validators.NucleicAcidValidator",
                               #  "newObjClass" = "ix.ginas.models.v1.Substance",
                                # "substanceClass" = "nucleicAcid"
                              # },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PolymerValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "polymer"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               # TODO katzelda FEb 2021 : turn off protein validator for now
                               #{
                               #  "validatorClass" = "ix.ginas.utils.validation.validators.ProteinValidator",
                               #  "newObjClass" = "ix.ginas.models.v1.Substance",
                                # "substanceClass" = "protein"
                                # "configClass" = "SubstanceValidatorConfig"
                               #},
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.StructurallyDiverseValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "structurallyDiverse"
                                 "configClass" = "SubstanceValidatorConfig"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.SSSG1Validator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "specifiedSubstanceG1"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.UnknownSubstanceClassValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NewSubstanceNonBatchLoadValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",

                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.UpdateSubstanceNonBatchLoaderValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",

                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PublicDomainRefValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance"
                               },
                                     {
                                       "validatorClass" = "ix.ginas.utils.validation.validators.DefinitionalHashValidator",
                                       "newObjClass" = "ix.ginas.models.v1.Substance"
                                     },

                             	# Added 9 November 2020 MAM
                             	#make sure than a public substance has at least one public definitional reference
                             	{
                                       "validatorClass" = "ix.ginas.utils.validation.validators.DefinitionalReferenceValidator",
                                       "newObjClass" = "ix.ginas.models.v1.Substance"
                                     },
                                     # Validator for Relationship modifications (restrict to admins)
                                     {
                                                     "validatorClass" = "ix.ginas.utils.validation.validators.RelationshipModificationValidator",
                                                     "newObjClass" = "ix.ginas.models.v1.Substance"
                                             },
                                             #Make sure each property has a name
                                             {
                                                        "validatorClass" = "ix.ginas.utils.validation.validators.PropertyValidator",
                                                        "newObjClass" = "ix.ginas.models.v1.Substance"
                                             },

                                     #check the mol files of chemical substances and throw errors if there are SUP s-groups.
                                     #to remove this check comment out or delete this statement.
                                     {
                                              "validatorClass" = "ix.ginas.utils.validation.validators.SuperatomValidator",
                                             "newObjClass" = "ix.ginas.models.v1.Substance",
                                             "substanceClass" = "chemical"

                                             }

]

##############################################
# THIS IS IMPORTANT, ADDITION OF VALIDATORS!
##############################################



        # TODO katzelda FEb 2021 : removed for now until we communicate with CV
#substance.validators += {
#                "validatorClass" = "ix.ginas.utils.validation.validators.CodeFormatValidator",
#                "newObjClass" = "ix.ginas.models.v1.Substance"
#        }

#TODO katzelda Feb 2021: remove for now
#Check that individual moieties of a multi-moiety chemical are registered separately
#substance.validators += {
#          "validatorClass" = "ix.ginas.utils.validation.validators.SaltValidator",
#          "newObjClass" = "ix.ginas.models.v1.ChemicalSubstance"
#        }
#check for uniqueness of several classes of substance based on definitional hashes
#substance.validators += {
#          "validatorClass" = "ix.ginas.utils.validation.validators.SubstanceUniquenessValidator",
#          "newObjClass" = "ix.ginas.models.v1.Substance"
#        }



spring.application.name=substance

logging.level.org.springframework.web=DEBUG

server.servlet-path=/loop-service

server.use-forward-headers=true


substance.definitionalElements.implementations = [
{
    "class" = "gsrs.module.substance.definitional.ChemicalSubstanceDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.sbustance.definitional.ModificationsDefintionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.MixtureDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.NonSubstanceConceptDefintionalElementImplementation"
},
{
    "class" = "gsrs.module.substance.definitional.NucleicAcidDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.ProteinSubstanceDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.PolymerDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.SSG1DefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.StructurallyDiverseDefinitionalElementImpl"
},
]

gsrs.validators.substances = [
                               # public Class validatorClass;
                               #  public Class substanceClass;
                               #  public Substance.SubstanceDefinitionType type;

                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.IgnoreValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "configClass" = "SubstanceValidatorConfig"
                               }
                               ]

ix.gsrs.delimitedreports.inchikeysforambiguousstereo=true
#List of ExportFactory classes that can export Substances
#the list of classes is ordered by priority
#if more than one Exporter supports the same file extension,
#the class in the list that supports it fist wins.

ix.ginas.export.factories.substances = [
    #"gsrs.module.substance.ExtraColumnsSpreadsheetExporterFactory",
	"gsrs.module.substance.exporters.SdfExporterFactory",
	"gsrs.module.substance.exporters.DefaultSubstanceSpreadsheetExporterFactory",
	"gsrs.module.substance.exporters.JsonExporterFactory",
	#"ix.ginas.exporters.FDANameExporterFactory",
	#"ix.ginas.exporters.FDACodeExporterFactory",
#	"ix.ginas.exporters.SPLValidatorXMLExporterFactory",
 # "ix.ginas.exporters.SRSLegacyDictionaryExporterFactory"

]

gsrs.entityProcessors=[
{
"entityClassName" = "ix.ginas.models.v1.Substance",
"processor" = "gsrs.module.substance.processors.ChemicalStructurePropertiesProcessor"
}
]